---
import ProfileMenuReact from "@/components/react/ProfileMenu";

const { userInfo, isLoggedIn } = Astro.locals;

interface UserData {
  userName?: string | null;
  userEmail?: string | null;
}

const getInitials = (
  name: UserData["userName"],
  email: string | undefined = "test@redil.com",
) => {
  if (name) {
    return name
      .split(" ")
      .map((n) => n[0])
      .join("")
      .toUpperCase()
      .slice(0, 2);
  }

  // Fallback to email if name is missing
  return (email ?? "RE")?.slice(0, 2).toUpperCase();
};

const slugProfile = isLoggedIn
  ? getInitials(userInfo?.userName, userInfo?.userEmail ?? undefined)
  : "";
---

<ProfileMenuReact
  client:load
  userInfo={userInfo ?? null}
  isLoggedIn={isLoggedIn}
  slugProfile={slugProfile}
/>
